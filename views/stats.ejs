<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <title>LOGIN</title>
</head>
<body>
      <% var chicken_taco_count = 0; %>
      <% var beef_taco_count = 0; %>    
      <% var tofu_taco_count = 0; %>
      <% var beans_count = 0; %>
      <% var chips_count = 0; %>
      <% var salsa_count = 0; %>
      <% var guacamole_count = 0; %>
      <% var brownrice_count = 0; %>     
      <% var coke_count = 0; %>
      <% var pepsi_count = 0; %>
      <% var sprite_count = 0; %>
      <% var drpepper_count = 0; %>
      <% var fanta_count = 0; %>
      <% var profit = 0; %>        

    <% var user; %>    
    <% for(var i=0; i<customers.length; i++) { %>
          <% if (customers[i].current_user == "True") { %>
            <% user = customers[i]; %>
         <% } %>
    <% } %> 
    <% if(user != null && user.admin == "True") { %>  
        <% for(var i=0; i<sales.length; i++) { %>
              <% chicken_taco_count += parseInt(sales[i].chicken_taco_count); %>
              <% beef_taco_count += parseInt(sales[i].beef_taco_count); %>
              <% tofu_taco_count += parseInt(sales[i].tofu_taco_count); %>
              <% beans_count += parseInt(sales[i].beans_count); %>
              <% chips_count += parseInt(sales[i].chips_count); %>
              <% salsa_count += parseInt(sales[i].salsa_count); %>
              <% guacamole_count += parseInt(sales[i].guacamole_count); %>
              <% brownrice_count += parseInt(sales[i].brownrice_count); %>  
              <% coke_count += parseInt(sales[i].coke_count); %>
              <% pepsi_count += parseInt(sales[i].pepsi_count); %>
              <% sprite_count += parseInt(sales[i].sprite_count); %>
              <% drpepper_count += parseInt(sales[i].drpepper_count); %>
              <% fanta_count += parseInt(sales[i].fanta_count); %> 
              <% profit += parseFloat(sales[i].sales); %> 
        <% } %>     

<h1>Statistics:</h1>
    <a href="/" class="btn btn-outline-primary col-md-3 mt-3">Go back to home page</a><br>
    <b>Taco sales:</b>
        <p>Chicken tacos: <%= chicken_taco_count %></p>
        <p>Beef tacos: <%= beef_taco_count %></p>
        <p>Tofu tacos: <%= tofu_taco_count %></p>
    <b>Side sales:</b>
        <p>Beans: <%= beans_count %></p>
        <p>Chips: <%= chips_count %></p>
        <p>Salsa: <%= salsa_count %></p>    
        <p>Guacamole: <%= guacamole_count %></p>    
        <p>Brown rice: <%= brownrice_count %></p>
    <b>Drink sales:</b>
        <p>Coke: <%= coke_count %></p>
        <p>Pepsi: <%= pepsi_count %></p>
        <p>Sprite: <%= sprite_count %></p>    
        <p>Dr Pepper: <%= drpepper_count %></p>    
        <p>Fanta: <%= fanta_count %></p>  
    <b>Total deliveries: <%= sales.length %></b><br>  
    <b>Total Profit: $<%= parseFloat(Math.round(profit * 100) / 100).toFixed(2) %></b>  
    
    <% } else { %>
        <h1>You do not have permissions to view this page</h1>
        <a href="/">Go back to home page</a>
    <% } %>
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>        
</body>
    
</html>